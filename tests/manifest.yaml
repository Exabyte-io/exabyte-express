tests:
  # Main definition for tests. An application can override these settings if defined in the `applications` yaml
  - name: total_energy
    comparison: assertAlmostEqual
  - name: fermi_energy
    comparison: assertAlmostEqual
  - name: npsins
    comparison: assertDeepAlmostEqual
  - name: eigenvalues_at_kpoints
    comparison: assertDeepAlmostEqual
  - name: ibz_k_points
    comparison: assertDeepAlmostEqual
  - name: convergence_electronic
    comparison: assertDeepAlmostEqual
  - name: convergence_ionic
    comparison: assertDeepAlmostEqual
  - name: stress_tensor
    comparison: assertDeepAlmostEqual
  - name: pressure
    comparison: assertAlmostEqual
  - name: total_force
    comparison: assertAlmostEqual
  - name: atomic_forces
    comparison: assertDeepAlmostEqual
  - name: total_energy_contributions
    comparison: assertDeepAlmostEqual
  - name: dos
    comparison: assertDeepAlmostEqual
  - name: phonon_dos
    comparison: assertDeepAlmostEqual
  - name: phonon_dispersion
    comparison: assertDeepAlmostEqual
  - name: magnetic_moments
    comparison: assertDeepAlmostEqual
  - name: reciprocal_lattice
    comparison: assertDeepAlmostEqual
  - name: realspace_lattice
    comparison: assertDeepAlmostEqual


applications: # fixtures/
  espresso: # fixtures/espresso/
    - 5.4.0: # fixtures/espresso/5.4.0/
        - path: pw.x/pw_scf # fixtures/espresso/5.4.0/pw.x/pw_scf/
          filename: pw-scf.out
          tests:
            # Array elements are a string or object
            - name: total_energy # TODO: Remove this when we make the final PR, since it's redundant information
              function: assertAlmostEqual
            - fermi_energy
            - nspins
            - eigenvalues_at_kpoints
            - ibz_k_points
            - convergence_electronic
            - convergence_ionic
            - stress_tensor
            - pressure
            - total_force
            - atomic_forces
            - total_energy_contributions
        - path: projwfc.x/dos
          filename: projwfc.out
          tests:
            - dos
        - path: matdyn.x/phonon_dos
          filename: phonon_dos.out
          tests:
            - phonon_dos
        - path: matdyn.x/phonons
          filename: normal_modes.out
          tests:
            - phonon_dispersion
    - 6.4.1:
        - path: pw.x/pw_scf
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
        - path: pw.x/pw_vc_relax
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
    - 6.5.0:
        - path: pw.x/pw_scf
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
        - path: pw.x/pw_vc_relax
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
    - 6.6.0:
        - path: pw.x/pw_scf
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
        - path: pw.x/pw_vc_relax
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
    - 6.7.0:
        - path: pw.x/pw_scf
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
        - path: pw.x/pw_vc_relax
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
    - 6.8.0:
        - path: pw.x/pw_scf
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice
        - path: pw.x/pw_vc_relax
          filename: pw.out
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - pressure
            - total_force
            - realspace_lattice
            - reciprocal_lattice

  vasp:
    - 5.3.5:
        - path: geom_relax
          filename: OUTCAR
          tests:
            - total_energy
            - fermi_energy
            - nspins
            - eigenvalues_at_koints
            - ibz_k_points
            - convergence_electronic
            - convergence_ionic
            - stress_tensor
            - pressure
            - total_force
            - atomic_forces
            - total_energy_contributions
        - path: geom_relax_restart
          filename: OUTCAR
          tests:
            - dos
        - path: scf_hse06
          filename: OUTCAR
          tests: []
        - path: noncollinear_scf
          filename: OUTCAR
          tests:
            - magnetic_moments

  nwchem:
    - 7.0.0:
        - path: scf
          filename: nwchem-total_energy.log
          tests:
            - total_energy
            - total_energy_contributions


# =================================================================================================================
# Miscellaneous
# These are tests that don't test a particular application, instead testing things like chemical structure parsing
# =================================================================================================================
test_molecule_inchi:
  structurePath: fixtures/structural/test-001/POSCAR

test_structure_vasp_basis:
  structurePath: fixtures/vasp/test-001/POSCAR

test_structure_vasp_lattice_bravais:
  structurePath: fixtures/vasp/test-001/POSCAR

test_structure_espresso_basis:
  structurePath: fixtures/espresso/test-001/pw-scf.in
  structureFormat: espresso-in

test_structure_espresso_lattice_bravais:
  structurePath: fixtures/espresso/test-001/pw-scf.in
  structureFormat: espresso-in
