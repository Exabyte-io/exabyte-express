tests:
  # Main definition for tests. An application can override these settings if defined in the `applications` yaml
  total_energy:
    comparison: assertAlmostEqual
  fermi_energy:
    comparison: assertAlmostEqual
  nspins:
    comparison: assertDeepAlmostEqual
  eigenvalues_at_kpoints:
    comparison: assertDeepAlmostEqual
  ibz_k_points:
    comparison: assertDeepAlmostEqual
  convergence_electronic:
    comparison: assertDeepAlmostEqual
  convergence_ionic:
    comparison: assertDeepAlmostEqual
  stress_tensor:
    comparison: assertDeepAlmostEqual
  pressure:
    comparison: assertAlmostEqual
  total_force:
    comparison: assertAlmostEqual
  atomic_forces:
    comparison: assertDeepAlmostEqual
  total_energy_contributions:
    comparison: assertDeepAlmostEqual
  dos:
    comparison: assertDeepAlmostEqual
  phonon_dos:
    comparison: assertDeepAlmostEqual
  phonon_dispersions:
    comparison: assertDeepAlmostEqual
  magnetic_moments:
    comparison: assertDeepAlmostEqual
  reciprocal_lattice:
    comparison: assertDeepAlmostEqual
  final_lattice_vectors:
    comparison: assertDeepAlmostEqual

test_config_schema:
  name: name of property to test
  comparison: assertion method to use to compare actual to expected
  places: number of decimal places to use in comparison
  reference_index: index of nested reference structure to use for comparison
  actual_index: index of nested actual parsed data to use for comparison

applications: # fixtures/
  espresso: # fixtures/espresso/
    5.4.0: # fixtures/espresso/5.4.0/
      - subdir: pw.x/pw_scf # fixtures/espresso/5.4.0/pw.x/pw_scf/
        filename: pw-scf.out
        tests:
          # Array elements are a string or object
          - name: total_energy
            comparison: assertAlmostEqual
            places: 3
          - fermi_energy
          - nspins
          - name: eigenvalues_at_kpoints
            actual_index: 0
          - ibz_k_points
          - convergence_electronic
          - convergence_ionic
          - stress_tensor
          - pressure
          - total_force
          - atomic_forces
          - total_energy_contributions
          - final_lattice_vectors
      - subdir: projwfc.x/dos
        filename: projwfc.out
        tests:
          - dos
      - subdir: matdyn.x/phonons
        filename: phonon_dos.out
        tests:
          - phonon_dos
      - subdir: matdyn.x/phonons
        filename: normal_modes.out
        tests:
          - phonon_dispersions
    6.4.1:
      - subdir: pw.x/pw_scf
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
      - subdir: pw.x/pw_vc_relax
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
    6.5.0:
      - subdir: pw.x/pw_scf
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
      - subdir: pw.x/pw_vc_relax
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
    6.6.0:
      - subdir: pw.x/pw_scf
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
      - subdir: pw.x/pw_vc_relax
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
    6.7.0:
      - subdir: pw.x/pw_scf
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
      - subdir: pw.x/pw_vc_relax
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
    6.8.0:
      - subdir: pw.x/pw_scf
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0
      - subdir: pw.x/pw_vc_relax
        filename: pw.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - pressure
          - total_force
          - final_lattice_vectors
          - name: eigenvalues_at_kpoints
            actual_index: 0

  vasp:
    5.3.5:
      - subdir: scf
        filename: vasp.out
        tests:
          - total_energy
          - fermi_energy
          - nspins
          - name: eigenvalues_at_kpoints
            actual_index: 0
          - ibz_k_points
          - convergence_electronic
          - convergence_ionic
          - stress_tensor
          - pressure
          - total_force
          - atomic_forces
          - total_energy_contributions
      - subdir: dos
        filename: chgcar.out
        tests:
          - dos
      - subdir: hse06
        filename: vasp.out
        tests: []
      - subdir: noncollinear_scf
        filename: vasp.out
        tests:
          - magnetic_moments

  nwchem:
    7.0.0:
      - subdir: scf
        filename: nwchem-total-energy.log
        tests:
          - total_energy
          - total_energy_contributions


# =================================================================================================================
# Miscellaneous
# These are tests that don't test a particular application, instead testing things like chemical structure parsing
# =================================================================================================================
test_molecule_inchi:
  structurePath: fixtures/structural/test-001/POSCAR

test_structure_vasp_basis:
  structurePath: fixtures/vasp/5.3.5/scf/POSCAR

test_structure_vasp_lattice_bravais:
  structurePath: fixtures/vasp/5.3.5/scf/POSCAR

test_structure_espresso_basis:
  structurePath: fixtures/espresso/5.4.0/pw.x/pw_scf/pw-scf.in
  structureFormat: espresso-in

test_structure_espresso_lattice_bravais:
  structurePath: fixtures/espresso/5.4.0/pw.x/pw_scf/pw-scf.in
  structureFormat: espresso-in
